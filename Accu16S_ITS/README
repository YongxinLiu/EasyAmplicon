Accu16S/AccuITS

Absolute Quantification Pipeline for Amplicon Sequencing Using Accu16S / AccuITS

Overview

EasyAmplicon is a reproducible Linux-based pipeline for absolute quantification of amplicon sequencing data using synthetic spike-in standards (Accu16S / AccuITS).
The workflow integrates spike-in read detection, ASV inference, and standard-curve-based absolute copy number estimation at DNA level and sample level.

The pipeline is designed for paired-end Illumina amplicon data (e.g. 16S rRNA gene, ITS), and supports downstream analysis using QIIME2, BLAT, BLAST, and R.

System Requirements

Operating system

Linux (Ubuntu ≥ 22.04, CentOS ≥ 7.7)

Windows 11 via WSL (Windows Subsystem for Linux) is supported

Hardware

Multi-core CPU recommended (≥ 8 threads)

≥ 16 GB RAM recommended for large datasets

Software Dependencies
Conda environment (basic tools)
conda create -n meta_env -y
conda activate meta_env
conda install -c bioconda blat fastx_toolkit seqtk parallel -y
conda install -c conda-forge coreutils gzip awk gawk -y

QIIME2 (Amplicon analysis)
wget http://www.imeta.science/db/qiime2/qiime2-amplicon-ubuntu-latest-conda.yml
conda env create \
  --name qiime2-amplicon-2025.4 \
  --file qiime2-amplicon-ubuntu-latest-conda.yml

conda activate qiime2-amplicon-2025.4
qiime --help

BLAST+

BLAST+ (≥ 2.17.0) is required for spike-in sequence matching.

wget ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-2.17.0+-x64-linux.tar.gz
tar -zxvf ncbi-blast-2.17.0+-x64-linux.tar.gz
export PATH=$PATH:/path/to/ncbi-blast-2.17.0+/bin

Directory Structure
EasyAmplicon/
├── seq/                  # Raw paired-end FASTQ files
├── db/                   # Spike-in reference databases
├── script/               # R scripts for absolute quantification
├── temp/                 # Intermediate files
├── result/               # Output results
└── README.md

Pipeline Overview
Step 0. Preparation

Set working directory

Create required folders

Normalize metadata file format (remove Windows CRLF and spaces)

sed -i 's/\r//;s/ //g' result/metadata.txt

Step 1. Spike-in Read Identification and Separation

Convert FASTQ → FASTA using seqtk

Align reads to spike-in reference using BLAT

Filter alignments by identity and alignment length

Identify spike-in read IDs

Split original FASTQ files into:

Client (biological) reads

Spike-in reads

Count spike-in reads per sample and per read direction (R1/R2)

Detect spike-ins with zero recovery

Step 2. ASV Inference (QIIME2 + DADA2)
2.1 Spike-in reads

Generate QIIME2 manifest

Import paired-end data

Adapter and primer trimming (cutadapt)

Denoising and chimera removal (DADA2)

Export ASV sequences and feature tables

2.2 Client (biological) reads

Same QIIME2 workflow as spike-in reads

Generate ASV table and representative sequences

Step 3. Absolute Quantification
3.1 Spike-in copy number extraction

Extract spike-in IR copy numbers

Extract DNA quantity per sample

Match sample names robustly

3.2 Spike-in ASV matching

Perform BLASTN between spike-in ASVs and spike-in reference database

Filter by:

Percent identity ≥ 96%

Alignment length ≥ 400 bp

Map ASVs to spike-in IDs

3.3 Standard curve fitting and copy number calculation

Using spike-in recovery and known input quantities:

Fit standard curves

Estimate:

Absolute ASV copy numbers

DNA-normalized absolute copy numbers

Sample-level absolute copy numbers

Implemented in R:

Rscript script/quantitation_calculate_absolute_copies.R \
  -o feature-table.txt \
  -s spike_otu.txt \
  -i spike_IR_copies.txt \
  -d DNA_quantity.txt \
  --output result/qiime2/6.final

Step 4. Final Output Files

All final results are collected in:

result/6.final/

File	Description
feature-table2.txt	ASV abundance table
dna-sequences.fasta	ASV representative sequences
standard_curve_formula.txt	Standard curve equations
absolute_otu.txt	Absolute ASV copy numbers
unit_dna_otu_copies.txt	DNA-normalized absolute copies
unit_sample_otu_copies.txt	Sample-level absolute copies
spike_otu.txt	Spike-in ASV abundance table
spike_reads_percent.txt	Spike-in recovery percentages
Applications

Absolute quantification of microbial communities

Cross-sample comparison of microbial load

Spike-in–based correction of sequencing depth bias

16S rRNA gene / ITS amplicon studies

Notes

Primer sequences, truncation lengths, and filtering thresholds should be adjusted according to experimental design.

Ensure correct sample naming consistency across FASTQ files, metadata, and spike-in tables.

Large datasets benefit from parallel computing.

Citation

If you use EasyAmplicon in your research, please cite or acknowledge the pipeline appropriately.
